<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 20px;
      margin: 0;
      background-color: #f5f5f5;
    }
    .container {
      max-width: 100%;
    }
    h1 {
      color: #1a73e8;
      font-size: 20px;
      margin-bottom: 20px;
      border-bottom: 2px solid #1a73e8;
      padding-bottom: 10px;
    }
    h2 {
      color: #5f6368;
      font-size: 16px;
      margin-top: 20px;
      margin-bottom: 10px;
    }
    .section {
      background-color: white;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.12);
    }
    .form-group {
      margin-bottom: 15px;
    }
    label {
      display: block;
      margin-bottom: 5px;
      color: #202124;
      font-weight: 500;
      font-size: 14px;
    }
    input[type="text"] {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid #dadce0;
      border-radius: 4px;
      font-size: 14px;
      box-sizing: border-box;
    }
    input[type="text"]:focus {
      outline: none;
      border-color: #1a73e8;
      box-shadow: 0 0 0 2px rgba(26,115,232,0.1);
    }
    .button-group {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }
    button {
      flex: 1;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    .btn-primary {
      background-color: #1a73e8;
      color: white;
    }
    .btn-primary:hover {
      background-color: #1765cc;
    }
    .btn-secondary {
      background-color: #f1f3f4;
      color: #202124;
    }
    .btn-secondary:hover {
      background-color: #e8eaed;
    }
    .btn-danger {
      background-color: #ea4335;
      color: white;
    }
    .btn-danger:hover {
      background-color: #c5221f;
    }
    .status-message {
      margin-top: 10px;
      padding: 10px;
      border-radius: 4px;
      font-size: 13px;
      display: none;
    }
    .status-success {
      background-color: #e8f5e9;
      color: #2e7d32;
      border: 1px solid #a5d6a7;
    }
    .status-error {
      background-color: #ffebee;
      color: #c62828;
      border: 1px solid #ef9a9a;
    }
    .help-section {
      background-color: #e8f0fe;
      padding: 15px;
      border-radius: 8px;
      margin-top: 20px;
    }
    .help-section h2 {
      color: #1a73e8;
      margin-top: 0;
    }
    .help-section ul {
      margin: 10px 0;
      padding-left: 20px;
    }
    .help-section li {
      margin-bottom: 8px;
      line-height: 1.6;
    }
    .help-section code {
      background-color: #f1f3f4;
      padding: 2px 6px;
      border-radius: 3px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
    }
    .info-text {
      font-size: 12px;
      color: #5f6368;
      margin-top: 5px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Driveæ•´ç† - è¨­å®š</h1>
    
    <div class="section">
      <h2>PARAåˆ†é¡ãƒ•ã‚©ãƒ«ãƒ€è¨­å®š</h2>
      
      <div class="form-group">
        <label for="projectFolderId">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ ãƒ•ã‚©ãƒ«ãƒ€ID</label>
        <input type="text" id="projectFolderId" placeholder="ãƒ•ã‚©ãƒ«ãƒ€IDã‚’å…¥åŠ›">
        <div class="info-text">My Driveç›´ä¸‹ã®ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€ãƒ•ã‚©ãƒ«ãƒ€ã®ID</div>
      </div>
      
      <div class="form-group">
        <label for="areaFolderId">ã‚¨ãƒªã‚¢ ãƒ•ã‚©ãƒ«ãƒ€ID</label>
        <input type="text" id="areaFolderId" placeholder="ãƒ•ã‚©ãƒ«ãƒ€IDã‚’å…¥åŠ›">
        <div class="info-text">My Driveç›´ä¸‹ã®ã€Œã‚¨ãƒªã‚¢ã€ãƒ•ã‚©ãƒ«ãƒ€ã®ID</div>
      </div>
      
      <div class="form-group">
        <label for="resourceFolderId">ãƒªã‚½ãƒ¼ã‚¹ ãƒ•ã‚©ãƒ«ãƒ€ID</label>
        <input type="text" id="resourceFolderId" placeholder="ãƒ•ã‚©ãƒ«ãƒ€IDã‚’å…¥åŠ›">
        <div class="info-text">My Driveç›´ä¸‹ã®ã€Œãƒªã‚½ãƒ¼ã‚¹ã€ãƒ•ã‚©ãƒ«ãƒ€ã®ID</div>
      </div>
      
      <div class="form-group">
        <label for="archiveFolderId">ã‚¢ãƒ¼ã‚«ã‚¤ãƒ– ãƒ•ã‚©ãƒ«ãƒ€ID</label>
        <input type="text" id="archiveFolderId" placeholder="ãƒ•ã‚©ãƒ«ãƒ€IDã‚’å…¥åŠ›">
        <div class="info-text">My Driveç›´ä¸‹ã®ã€Œã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã€ãƒ•ã‚©ãƒ«ãƒ€ã®ID</div>
      </div>
      
      <div class="button-group">
        <button class="btn-primary" onclick="saveSettings()">è¨­å®šã‚’ä¿å­˜</button>
        <button class="btn-secondary" onclick="loadSettings()">è¨­å®šã‚’èª­ã¿è¾¼ã¿</button>
      </div>

      <div id="statusMessage" class="status-message"></div>
    </div>

    <div class="section">
      <h2>åˆ—ã®è¡¨ç¤ºè¨­å®š</h2>
      <div class="button-group">
        <button class="btn-secondary" onclick="toggleFileIdColumn()">ãƒ•ã‚©ãƒ«ãƒ€IDåˆ— è¡¨ç¤º/éè¡¨ç¤º</button>
      </div>
    </div>
    
    <div class="help-section">
      <h2>ğŸ“– ãƒ˜ãƒ«ãƒ—</h2>
      <h3>ä½¿ã„æ–¹</h3>
      <ul>
        <li><strong>ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã‚’å–å¾—</strong>: ã€ŒDriveæ•´ç†ã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€Œãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã‚’å–å¾—ã€ã‚’é¸æŠã™ã‚‹ã¨ã€My Driveç›´ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«å±•é–‹ã•ã‚Œã¾ã™ã€‚</li>
        <li><strong>ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç§»å‹•</strong>: ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ã€Œç§»å‹•ã€åˆ—ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¦ã€ã€Œãƒã‚§ãƒƒã‚¯æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç§»å‹•ã€ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚</li>
        <li><strong>ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å¤‰æ›´</strong>: ã€Œæ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«åã€åˆ—ã«æ–°ã—ã„åå‰ã‚’å…¥åŠ›ã—ã¦ã€ã€Œåå‰å¤‰æ›´ã‚’å®Ÿè¡Œã€ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚</li>
      </ul>
      
      <h3>ãƒ•ã‚©ãƒ«ãƒ€IDã®å–å¾—æ–¹æ³•</h3>
      <ul>
        <li>Google Driveã§ãƒ•ã‚©ãƒ«ãƒ€ã‚’é–‹ãã¾ã™</li>
        <li>ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã‹ã‚‰URLã‚’ç¢ºèªã—ã¾ã™</li>
        <li>URLã® <code>/folders/</code> ã®å¾Œã«ã‚ã‚‹æ–‡å­—åˆ—ãŒãƒ•ã‚©ãƒ«ãƒ€IDã§ã™</li>
        <li>ä¾‹: <code>https://drive.google.com/drive/folders/1ABC123xyz...</code> ã®å ´åˆã€<code>1ABC123xyz...</code> ãŒãƒ•ã‚©ãƒ«ãƒ€ID</li>
      </ul>
      
      <h3>æ³¨æ„äº‹é …</h3>
      <ul>
        <li>ãƒ•ã‚©ãƒ«ãƒ€IDã¯å¿…ãšæ­£ã—ã„ã‚‚ã®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</li>
        <li>ç§»å‹•ã‚„ãƒªãƒãƒ¼ãƒ ã¯å…ƒã«æˆ»ã›ã¾ã›ã‚“ã€‚å®Ÿè¡Œå‰ã«ç¢ºèªã—ã¦ãã ã•ã„</li>
        <li>å¤§é‡ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€åº¦ã«å‡¦ç†ã™ã‚‹å ´åˆã¯æ™‚é–“ãŒã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™</li>
      </ul>
    </div>
  </div>
  
  <script>
    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«è¨­å®šã‚’èª­ã¿è¾¼ã‚€
    window.onload = function() {
      loadSettings();
    };
    
    // è¨­å®šã‚’èª­ã¿è¾¼ã‚€
    function loadSettings() {
      google.script.run
        .withSuccessHandler(function(config) {
          document.getElementById('projectFolderId').value = config.projectFolderId || '';
          document.getElementById('areaFolderId').value = config.areaFolderId || '';
          document.getElementById('resourceFolderId').value = config.resourceFolderId || '';
          document.getElementById('archiveFolderId').value = config.archiveFolderId || '';

          showStatus('è¨­å®šã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ', 'success');
        })
        .withFailureHandler(function(error) {
          showStatus('è¨­å®šã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'error');
        })
        .getConfig();
    }
    
    // è¨­å®šã‚’ä¿å­˜
    function saveSettings() {
      var config = {
        projectFolderId: document.getElementById('projectFolderId').value.trim(),
        areaFolderId: document.getElementById('areaFolderId').value.trim(),
        resourceFolderId: document.getElementById('resourceFolderId').value.trim(),
        archiveFolderId: document.getElementById('archiveFolderId').value.trim()
      };

      // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
      var hasError = false;
      var errorMessage = '';

      // ãƒ•ã‚©ãƒ«ãƒ€IDã®æ¤œè¨¼ï¼ˆå…¥åŠ›ã•ã‚Œã¦ã„ã‚‹å ´åˆã®ã¿ï¼‰
      var folderIds = [
        { key: 'projectFolderId', name: 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ', value: config.projectFolderId },
        { key: 'areaFolderId', name: 'ã‚¨ãƒªã‚¢', value: config.areaFolderId },
        { key: 'resourceFolderId', name: 'ãƒªã‚½ãƒ¼ã‚¹', value: config.resourceFolderId },
        { key: 'archiveFolderId', name: 'ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–', value: config.archiveFolderId }
      ];
      
      // éåŒæœŸã§æ¤œè¨¼ï¼ˆç°¡æ˜“ç‰ˆï¼šä¿å­˜ã®ã¿å®Ÿè¡Œï¼‰
      google.script.run
        .withSuccessHandler(function(result) {
          if (result.success) {
            showStatus(result.message, 'success');
          } else {
            showStatus(result.message, 'error');
          }
        })
        .withFailureHandler(function(error) {
          showStatus('è¨­å®šã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'error');
        })
        .saveConfig(config);
    }
    
    // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
    function showStatus(message, type) {
      var statusDiv = document.getElementById('statusMessage');
      statusDiv.textContent = message;
      statusDiv.className = 'status-message status-' + type;
      statusDiv.style.display = 'block';

      // 3ç§’å¾Œã«è‡ªå‹•ã§éè¡¨ç¤º
      setTimeout(function() {
        statusDiv.style.display = 'none';
      }, 3000);
    }

    // ãƒ•ã‚©ãƒ«ãƒ€IDåˆ—ã®è¡¨ç¤º/éè¡¨ç¤ºã‚’åˆ‡ã‚Šæ›¿ãˆ
    function toggleFileIdColumn() {
      google.script.run
        .withSuccessHandler(function(result) {
          showStatus('ãƒ•ã‚©ãƒ«ãƒ€IDåˆ—ã®è¡¨ç¤ºã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã—ãŸ', 'success');
        })
        .withFailureHandler(function(error) {
          showStatus('ã‚¨ãƒ©ãƒ¼: ' + error.message, 'error');
        })
        .toggleFileIdColumn();
    }
  </script>
</body>
</html>
