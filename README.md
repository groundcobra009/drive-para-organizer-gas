# Drive PARA Organizer (GAS)

Google DriveのMy Drive直下のファイルをPARAメソッドに基づいて整理するためのGoogle Apps Scriptツールです。

## 概要

My Drive直下のファイルをスプレッドシートに一覧表示し、「プロジェクト」「エリア」「リソース」「アーカイブ」の4つのフォルダに分類・移動できます。ファイル名の変更も直接スプレッドシートから行えます。

## 機能

### 主な機能
- **ファイル一覧の取得**: My Drive直下のファイル（フォルダを除く）を自動取得
- **PARA分類移動**: ドロップダウンで移動先を選択し、チェックボックスで一括移動
- **ファイル名変更**: スプレッドシートのB列を編集すると自動的にDrive上のファイル名も変更
- **プレビュー**: H列のURLからファイルを直接プレビュー可能
- **フォルダID列の表示/非表示**: 不要な情報を隠して見やすく

### PARAメソッドとは
- **プロジェクト (Projects)**: 期限のある具体的なタスク
- **エリア (Areas)**: 継続的な責任領域
- **リソース (Resources)**: 参考資料や学習素材
- **アーカイブ (Archive)**: 完了または非アクティブな項目

## セットアップ

### 1. Google Apps Scriptプロジェクトの作成
1. Google スプレッドシートを新規作成
2. 「拡張機能」→「Apps Script」を開く
3. 以下のファイルを作成し、コードをコピー:
   - `Code.gs`
   - `DriveService.gs`
   - `ConfigService.gs`
   - `UI.gs`
   - `Sidebar.html`

### 2. PARAフォルダの準備
1. My Drive直下に以下の4つのフォルダを作成:
   - プロジェクト
   - エリア
   - リソース
   - アーカイブ

2. 各フォルダのIDを取得:
   - Google Driveでフォルダを開く
   - ブラウザのアドレスバーから `/folders/` の後の文字列をコピー
   - 例: `https://drive.google.com/drive/folders/1ABC123xyz...` → `1ABC123xyz...`

### 3. 設定
1. スプレッドシートで「Drive整理」メニューから「設定を開く」を選択
2. 各フォルダのIDを入力して保存

## 使い方

### ファイル一覧の取得
1. 「Drive整理」→「ファイル一覧を取得」をクリック
2. My Drive直下のファイルがスプレッドシートに展開されます

### ファイルの移動
1. G列（移動先）のドロップダウンから移動先を選択
2. A列（移動）にチェックを入れる
3. 「Drive整理」→「チェック済みファイルを移動」をクリック

### ファイル名の変更
1. B列（ファイル名）を直接編集
2. Enter キーを押すと自動的にDrive上のファイル名も変更されます

### ファイルのプレビュー
- H列のURLをクリックすると、ファイルをブラウザで開けます

### フォルダID列の表示/非表示
- サイドバーの「列の表示設定」から「フォルダID列 表示/非表示」ボタンをクリック
- または「Drive整理」メニューから選択

## スプレッドシートの列構成

| 列 | 項目 | 説明 |
|---|---|---|
| A | 移動 | チェックボックス（移動対象） |
| B | ファイル名 | 編集すると自動的にDrive上も変更 |
| C | ファイルID | Drive内部ID（表示/非表示切替可能） |
| D | 種類 | MIMEタイプ |
| E | 更新日時 | 最終更新日時 |
| F | サイズ | ファイルサイズ |
| G | 移動先 | ドロップダウンで選択 |
| H | URL | ファイルへの直接リンク |

## トリガー

### onOpen()
- スプレッドシート起動時に「Drive整理」メニューを自動追加

### onEdit(e)
- B列（ファイル名）の編集を検知
- 自動的にGoogle Drive上のファイル名を変更
- エラー時は元の値に復元

## 注意事項

- **バックアップ**: 移動やリネームは元に戻せません。実行前に確認してください
- **フォルダの除外**: My Drive直下のフォルダは一覧に表示されません（ファイルのみ）
- **権限**: 初回実行時にGoogle Driveへのアクセス権限の承認が必要です
- **大量ファイル**: 多数のファイルを一度に処理する場合、時間がかかる場合があります

## トラブルシューティング

### 「設定が完了していません」と表示される
→ 「設定を開く」から4つのフォルダIDを入力してください

### ファイル名の変更に失敗する
→ ファイルの編集権限があるか確認してください

### フォルダIDが無効と表示される
→ フォルダIDが正しいか、アクセス権限があるか確認してください

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 参考

- [PARAメソッド](https://fortelabs.com/blog/para/)
- [Google Apps Script ドキュメント](https://developers.google.com/apps-script)
